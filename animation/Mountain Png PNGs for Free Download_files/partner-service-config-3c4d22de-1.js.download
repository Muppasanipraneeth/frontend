import{a as p}from"./index-fb2f77fe-1.js";import"./_commonjsHelpers-de833af9-1.js";class f{constructor(i){this.apiConfig=i,sessionStorage.getItem("pscfgoverride")&&(this.overrideConfig=JSON.parse(sessionStorage.getItem("pscfgoverride"))),p.get(`${this.apiConfig.baseUrl}/api/v3/config`,{params:this.commonParams()}).then(e=>{let r={couponUrl:e.data.coupon_url,direct:e.data.direct,directUrl:e.data.direct_url,indirect:e.data.indirect,indirectUrl:e.data.indirect_url,provider:e.data.provider};this.overrideConfig&&(console.debug("before ps cfg override",r),r={...r,...this.overrideConfig},console.debug("after ps cfg override",r)),this.serviceConfig=r})}ready(){return!!this.serviceConfig}couponInfo(i){var e,r,o;return{code:(e=i.coupon)==null?void 0:e.code,expDate:(r=i.coupon)==null?void 0:r.exp_date,percent:(o=i.coupon)==null?void 0:o.percent}}couponUrl(){const i=new URLSearchParams({...this.commonParams(),"c[pl]":"coupon"});return`${this.serviceConfig.couponUrl}?${i.toString()}`}directUrl({backfillImageUrl:i,padWithTerms:e,page:r,placement:o,perPage:n,searchTerm:s}){const t=new URLSearchParams({...this.commonParams(),pp:80});return i&&t.set("biu",i),e&&t.set("pt",e),r&&t.set("p",r),n&&t.set("pp",n),o&&t.set("c[pl]",o),s&&t.set("t",s),`${this.serviceConfig.directUrl}?${t.toString()}`}indirectUrl({placement:i,searchTerm:e}){const r=new URLSearchParams({...this.commonParams()});return i&&r.set("c[pl]",i),e&&r.set("t",e),`${this.serviceConfig.indirectUrl}?${r.toString()}`}partnerConfig(i){var r;const e=this.apiConfig.partners[i];return{...e,name:(e==null?void 0:e.name)||this.provider(),logo_path:(r=e==null?void 0:e.logo_path)==null?void 0:r.replace("frontend/components/partner/img/","")}}provider(){var i;return(i=this.serviceConfig)==null?void 0:i.provider}showDirect(){var i;return(i=this.serviceConfig)==null?void 0:i.direct}showIndirect(){var i;return(i=this.serviceConfig)==null?void 0:i.indirect}commonParams(){var e;const i={ct:this.apiConfig.params.contentType,h:window.location.hostname,l:this.apiConfig.params.locale,pv:this.apiConfig.params.pageviewGuid,sg:this.apiConfig.params.sessionGuid,s:this.apiConfig.params.site};return this.pageKey()&&(i["c[pk]"]=this.pageKey()),this.apiConfig.params.searchTerm&&(i.t=this.apiConfig.params.searchTerm),this.apiConfig.params.splitTestName&&(i["c[st]"]=this.apiConfig.params.splitTestName),this.apiConfig.params.splitTestVariant&&(i["c[sv]"]=this.apiConfig.params.splitTestVariant),(e=this.overrideConfig)!=null&&e.provider&&(i["c[p]"]=this.overrideConfig.provider),i}pageKey(){if(!this.apiConfig.params.pageKey)return null;switch(this.apiConfig.params.pageKey){case"searches":return"search";case"resources":return"show";default:return null}}}function c(){if(window.partnerService)return;const a=document.getElementById("partner-service-api-config");if(!a)return;const i=JSON.parse(a.textContent);window.partnerService=new f(i)}c();window.addEventListener("turbo:visit",()=>{window.partnerService=null});window.addEventListener("turbo:load",c);
