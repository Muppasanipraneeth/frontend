import{r as f}from"./stimulus-helpers-17f3c993-1.js";import{E as n}from"./ez-base-controller-242f2ed1-1.js";import{sendTrackingEvent as a,findCategoryByElement as E,trackCompleteEvent as b}from"./tracking-39df6e64-1.js";import{a$ as _,ar as M,p as k,n as T,J as I,k as N,b0 as y,b1 as O,b2 as S,b3 as H,b4 as P,b5 as x,b6 as F,b7 as q,b8 as A,b9 as w}from"./actions-c6ee89d5-1.js";import{M as d}from"./media-matcher-b9d0b27a-1.js";import{a as R}from"./ajax-helpers-cd784e25-1.js";import{C as B}from"./js-5386754e-1.js";import"./performance-helpers-20b701c9-1.js";import"./helpers-aaf8efb9-1.js";import"./init-user-58d04eb1-1.js";import"./_commonjsHelpers-de833af9-1.js";import"./index-fb2f77fe-1.js";import"./modal_helpers-90654892-1.js";import"https://unpkg.com/comlink/dist/esm/comlink.mjs";const c=new d;class u extends n{constructor(){super(...arguments),this.isVisible=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),this.trackExploreClick=e=>{a({element:e.target,data:{action:_,label:`Link-${e.target.dataset.englishLabel}`,content_type:`Content-${e.target.dataset.contentType}`}})}}connect(){this.hasMobileMenuTarget&&(this.setupSearchCloseQueries(),c.evaluateAll(),c.addListeners())}disconnect(){c.removeListeners(),c.clearQueries()}clearSearchInput(){requestAnimationFrame(()=>{this.searchField.value="",this.searchField.focus()})}hideOnClickOutside(){const e=i=>{!this.element.contains(i.target)&&this.isVisible(this.element)&&(requestAnimationFrame(()=>{document.body.classList.toggle("is-mobile-search")}),t())},t=()=>{document.removeEventListener("click",e)};setTimeout(()=>{document.addEventListener("click",e)},50)}toggleMobileSearch(){const e=document.body;requestAnimationFrame(()=>{e.classList.toggle("is-mobile-search"),e.classList.contains("is-mobile-search")?(this.hideOnClickOutside(),requestAnimationFrame(()=>{this.savedVal=this.searchField.value,this.searchField.focus(),this.searchField.value="",this.searchField.value=this.savedVal})):requestAnimationFrame(()=>{this.searchField.value="",this.searchField.value=this.savedVal})})}setupSearchCloseQueries(){c.addMediaQuery("(max-width: 635px)",null,()=>{document.querySelector(".ez-dark-overlay.mobile-search-overlay")&&this.toggleMobileSearch()})}rebuyCredits(e){a({element:e.currentTarget,data:{action:M}})}headerLogin(){a({element:this.loginButtonTarget,data:{action:k}})}headerSignUp(){a({element:this.signupButtonTarget,data:{action:T}})}sendHeaderJoinProEvent(e){const t=E(e.target);a({element:e.target,data:{action:I,category:t}}),b({action:N,category:t})}get searchField(){return this.element.querySelector(".ez-search-form__input")}}u.targets=["mobileMenu","loginButton","signupButton"];class U extends n{constructor(){super(...arguments),this.actionsMap={bundles:y,photos:O,vectors:S,videos:H,png:P,psd:x,svg:F,editor_template:q}}trackMenuClick({target:e,params:t}){const{contentType:i}=t,s=this.getTrackingContentType(i,e);a({data:{action:this.actionsMap[s],label:"menu",category:"Header"}})}trackExploreCategoryClick({target:e,params:t}){const{category:i,contentType:s}=t,o=this.getTrackingContentType(s,e);a({data:{action:this.actionsMap[o],label:`search-${i}`,category:"Header"}})}trackExploreLinkClick({target:e,params:t}){const{linkTitle:i,contentType:s}=t,o=this.getTrackingContentType(s,e);a({data:{action:this.actionsMap[o],label:`link-${i}`,category:"Header"}})}getTrackingContentType(e,t){if(e&&Object.prototype.hasOwnProperty.call(this.actionsMap,e))return e;const i=t.closest(".ez-drop-down__title")||t.closest(".mobile-menu-group__title");return i==null?void 0:i.dataset.title}}const l=new d;class m extends n{constructor(){super(...arguments),this.addParentNavHover=()=>{this.hasItemNavTarget&&this.itemNavTarget.addEventListener("mouseleave",this.leavingSubmenuParent)},this.removeParentNavHover=()=>{this.hasItemNavTarget&&this.itemNavTarget.removeEventListener("mouseleave",this.leavingSubmenuParent)},this.addMenuHovers=()=>{this.itemTargets.forEach(e=>{e.addEventListener("mouseenter",this.enterMenuItem),e.addEventListener("mouseleave",this.leaveMenuItem)})},this.removeMenuHovers=()=>{this.itemTargets.forEach(e=>{e.removeEventListener("mouseenter",this.enterMenuItem),e.removeEventListener("mouseleave",this.leaveMenuItem)})},this.enterMenuItem=e=>{e.currentTarget.classList.add("is-hovered"),e.target.parentElement.classList.contains("is-hovered")?e.target.classList.contains("is-hovered")&&requestAnimationFrame(()=>{e.target.classList.add("is-active")}):setTimeout(()=>{e.target.classList.contains("is-hovered")&&requestAnimationFrame(()=>{e.target.classList.add("is-active"),e.target.parentElement.classList.add("is-hovered")})},375)},this.leaveMenuItem=e=>{requestAnimationFrame(()=>{e.target.classList.remove("is-hovered","is-active")}),e.target.querySelector(".ez-drop-down__submenu")&&this.itemNavTarget.addEventListener("mouseleave",this.leavingSubmenuParent)},this.leavingSubmenuParent=e=>{requestAnimationFrame(()=>{e.target.classList.remove("is-hovered")})}}connect(){this.setupMenuMediaQueries(),l.evaluateAll(),l.addListeners()}disconnect(){l.removeListeners(),l.clearQueries()}setupMenuMediaQueries(){l.addMediaQuery("(min-width: 801px)",()=>{this.addMenuHovers(),this.addParentNavHover()},()=>{this.removeMenuHovers(),this.removeParentNavHover()})}}m.targets=["itemNav","item"];class h extends n{constructor(){super(...arguments),this.hideMenuItems=e=>{this.menuItemTargets.forEach(t=>{t!==e&&requestAnimationFrame(()=>{t.classList.remove("is-active")})})}}connect(){new window.SiteHeaderDecorator().init({context:this.element}),window.addEventListener("CloseExploreSubMenus",this.hideMenuItems)}disconnect(){window.removeEventListener("CloseExploreSubMenus",this.hideMenuItems)}menuItemClicked(e){const t=e.currentTarget.closest(".mobile-menu-group__title");requestAnimationFrame(()=>{t.classList.contains("is-active")?document.querySelector("body").classList.remove("has-active-mobile-submenu"):document.querySelector("body").classList.add("has-active-mobile-submenu"),t.classList.toggle("is-active")}),this.hideMenuItems(t)}}h.targets=["menuItem"];class $ extends n{connect(){new window.SiteHeaderDecorator().init({context:this.element})}}class g extends n{connect(){this.contentRequested=!1,this.seenCookieUpdated=!1,this.activeIds=JSON.parse(this.unseenBadgeTarget.dataset.activeNotifications),this.seenIds=JSON.parse(this.unseenBadgeTarget.dataset.seenNotifications),this.flagLoaded()}getMarketingNotifications(){this.contentRequested||(this.contentRequested=!0,R("/api/v2/marketing_notifications",e=>{this.setNotifications(e.data.marketing_notifications)},e=>{console.error(e)}))}setNotifications(e){if(this.spinnerTarget.classList.add("is-hidden"),e.length===0){this.noNotifications();return}e.forEach((t,i)=>{const s=this.marketingTemplate(t,i+1);requestAnimationFrame(()=>{this.listTarget.insertAdjacentHTML("beforeend",s)})})}noNotifications(){const e=`
      <li class="notification-item no-notifications">
        <h3>Currently no notifications</h3>
        <p>Please check back later</p>
      </li>
    `;requestAnimationFrame(()=>{this.listTarget.insertAdjacentHTML("beforeend",e)})}menuClick(e){e.currentTarget.parentNode.classList.contains("is-closed")&&(this.getMarketingNotifications(),this.seenCookieUpdated||(this.seenCookieUpdated=!0,this.updateSeenCookie()),this.sendOpenClick(e,this.activeIds.length))}updateSeenCookie(){const e=this.seenIds;if(this.activeIds){this.activeIds.forEach(i=>{e.includes(i)||e.push(i)});let t=0;for(;t<e.length&&!(e.length<=100);)this.activeIds.indexOf(e[t])===-1&&(e.splice(t,1),t-=1),t+=1;B.set("seen_notifications",JSON.stringify(e)),this.setSeenBadge()}}sendOpenClick(e,t){a({element:e.currentTarget,data:{action:A,category:"Header",value:t}})}sendCompleteEvent(e){a({element:e.currentTarget,data:{action:w,category:"Header",label:e.currentTarget.dataset.trackingLabel,value:parseInt(e.currentTarget.dataset.position,10)}})}marketingTemplate(e,t){const{id:i,title:s,url:o,new_tab:p,image:v,button_text:C}=e,L=`
      href="${o}"
      data-action="click->notifications-menu#sendCompleteEvent"
      data-tracking-label="${s}"
      data-position="${t}"
      ${p?'target="_blank"':""}
    `;return`
      <li class="notification-item marketing-notification" data-id="${i}">
        <a ${L}>
          <img src="${v.large.url}" onerror="this.remove();" />
          <h6 class="marketing-notification__title">${s}</h6>
          <button class="ez-btn ez-btn--medium marketing-notification__btn">${C}</button>
        </a>
      </li>
    `}setSeenBadge(){requestAnimationFrame(()=>{this.unseenBadgeTarget.innerHTML="",this.unseenBadgeTarget.classList.add("is-hidden")})}}g.targets=["menuButton","list","unseenBadge","spinner"];f([["site-header",u],["menu-tracking",U],["explore-nav",m],["mobile-menu",h],["user-menu",$],["notifications-menu",g]]);
